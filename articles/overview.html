<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="unrepx">
<title>**unrepx** package for R • unrepx</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="**unrepx** package for R">
<meta property="og:description" content="unrepx">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">unrepx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/overview.html">**unrepx** package for R</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rvlenth/unrepx/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>**unrepx** package for R</h1>
            <h3 data-toc-skip class="subtitle">Analysis of unreplicated
experiments</h3>
                        <h4 data-toc-skip class="author">Russ Lenth</h4>
            
            <h4 data-toc-skip class="date">Version 1.0.3 –
2024-06-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/unrepx/blob/HEAD/vignettes/overview.Rmd" class="external-link"><code>vignettes/overview.Rmd</code></a></small>
      <div class="d-none name"><code>overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>unrepx</strong> package provides much of what one needs
to analyze basic unreplicated screening experiments such as two-level
factorial and fractional factorial designs, in which one has a set of
independent effect estimates but no degrees of freedom for error. The
analyses are based on these underlying assumptions about the effect
estimates:</p>
<ul>
<li>They are independent</li>
<li>They all have the same variance</li>
<li>They are normally distributed</li>
<li>Many of the effects are inactive (negligible), while a minority of
them are active (non-negligible). This requirement is known as the
<em>effect-sparsity</em> assumption.</li>
</ul>
<p>The first and last of these are the most important. There are several
cases in which effects are not independent – among them Plackett-Burman
designs and definitive screening designs – for which other software is
needed. And without the effect-sparsity assumption, one needs
replications, or some other assumption, in order to assess which effects
are likely to be active.</p>
<p>This document provides an overview and a few examples. The user
should consult the help pages for details and finer points.</p>
</div>
<div class="section level2">
<h2 id="estimating-effects">Estimating effects<a class="anchor" aria-label="anchor" href="#estimating-effects"></a>
</h2>
<p>The functions <code><a href="../reference/yates.html">yates()</a></code> and <code><a href="../reference/yates.html">gyates()</a></code> allow
estimation of effects without also providing a design matrix. Instead,
the response values must be arranged in standard order, whereby the
first factor varies the fastest, the second the second fastest, and so
on. See <code><a href="../reference/yates.html">help("yates")</a></code> for details on these functions, as
well as literature references.</p>
<p>As an example, consider the pilot-plant example given in the text by
Box, Hunter, and Hunter (2nd ed.), page 177. The experiment involves
three factors T, C, and K, each having two levels. Here we estimate the
effects of these factors on process yield, by providing the response
values in standard order (as presented in the text):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rvlenth/unrepx" class="external-link">"unrepx"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: unrepx</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="va">pilotEff</span> <span class="op">=</span> <span class="fu"><a href="../reference/yates.html">yates</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">72</span>,<span class="fl">54</span>,<span class="fl">68</span>,<span class="fl">52</span>,<span class="fl">83</span>,<span class="fl">45</span>,<span class="fl">80</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T"</span>,<span class="st">"C"</span>,<span class="st">"K"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    T    C   TC    K   TK   CK  TCK </span></span>
<span><span class="co">## 23.0 -5.0  1.5  1.5 10.0  0.0  0.5 </span></span>
<span><span class="co">## attr(,"mean")</span></span>
<span><span class="co">##       </span></span>
<span><span class="co">## 64.25</span></span></code></pre>
<p>Note there are 7 effects from the 8 experimental runs; the mean is
added as an attribute.</p>
<p>The <code><a href="../reference/yates.html">yates()</a></code> and <code><a href="../reference/yates.html">gyates()</a></code> functions can also
reverse themselves and produce the original response values, given the
effects. They decide which to do based on the length of the data
provided.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/yates.html">yates</a></span><span class="op">(</span><span class="va">pilotEff</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## --- +-- -+- ++- --+ +-+ -++ +++ </span></span>
<span><span class="co">##  60  72  54  68  52  83  45  80</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="graphical-analyses">Graphical analyses<a class="anchor" aria-label="anchor" href="#graphical-analyses"></a>
</h2>
<p><strong>unrepx</strong> provides three graphical tools for helping to
identify active effects: <em>[half]-normal plots</em>, <em>reference
plots</em>, and <em>Pareto plots</em>.</p>
<p>Half-normal and normal plots are available via <code><a href="../reference/hnplot.html">hnplot()</a></code>
(see details in its help page). Here is a half-normal plot of the
effects we just computed, with labels added for all those that exceed
10:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hnplot.html">hnplot</a></span><span class="op">(</span><span class="va">pilotEff</span>, ID <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Half-normal plot of the pilot-plant effects"</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<p>By default, a reference line is added (see the section below on
statistics for details). The dots are colored blue for positive and red
for negative effects. Visually, it appears that the <em>T</em> and
<em>TK</em> effects are the most active, as they appear to be outliers.
Ordinary normal plots are possible too, but we strongly discourage using
them as they can be misleading.</p>
<p>A reference plot is a dotplot of the effects, along with a reference
curve. By default, the absolute effects are plotted along with a
half-normal curve:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/refplot.html">refplot</a></span><span class="op">(</span><span class="va">pilotEff</span>, ID <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Reference plot of the pilot-plant effects"</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
<p>As a by-product, a general-purpose <code>dot.plot</code> function is
also provided. These plots are resizeable in both directions: with a
vertical resize, the dots are re-stacked with the correct spacing; and
with a horizontal resize, the dots may be re-binned.</p>
<p>Pareto plots are produced using <code><a href="../reference/parplot.html">parplot()</a></code>. The plot is a
bar graph with the bars ordered by the size of the effect. In addition,
cutoff line(s) are added for the margin of error (ME) and the
simultaneous margin of error (SME) of the effects (see the section below
on statistics).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/parplot.html">parplot</a></span><span class="op">(</span><span class="va">pilotEff</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Pareto plot of the pilot-plant effects"</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="statistics">Statistics<a class="anchor" aria-label="anchor" href="#statistics"></a>
</h2>
<p>You may have noticed that all of the plots we have seen are enhanced
by lines or curves that help to identify active effects. This is done
via a <em>pseudo-standard-error</em> estimate. The effect-sparsity and
equal-variances assumptions suggests that an estimate of the standard
error of the effects may be obtained by looking at the variability of
the smaller effects. The <code><a href="../reference/PSE.html">PSE()</a></code> function calculates these
estimates.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PSE.html">PSE</a></span><span class="op">(</span><span class="va">pilotEff</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Zahn_PSE </span></span>
<span><span class="co">## 4.011005</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PSE.html">PSE</a></span><span class="op">(</span><span class="va">pilotEff</span>, method <span class="op">=</span> <span class="st">"Lenth"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Lenth_PSE </span></span>
<span><span class="co">##      2.25</span></span></code></pre>
<p>See <code><a href="../reference/PSE.html">help("PSE")</a></code> for a list of the available methods. The
default Zahn method is based on the slope of a line through the origin
fitted to the smallest 2/3 of the points in the half-normal plot.</p>
<p>For any PSE estimate, one can compute a <em>t</em>-like statistic via
dividing the effect estimate by the PSE. In turn, there is an associated
<em>reference distribution</em> that can be estimated by simulating the
<em>t</em> statistics for independent inactive effects. (It can be
accessed if you like via the <code><a href="../reference/refdist.html">ref.dist()</a></code> function; see its
help page. Ordinarily, though, the needed simulations are done – and
stored – in the background as needed.) A high percentile (typically the
95th) of the reference distribution of |<em>t</em>| provides a critical
value. This critical value, multiplied by the PSE, gives a <em>margin of
error</em> for assessing the effects. This value is used in obtaining
the cutoff line labeled “ME” in the Pareto plot.</p>
<p>If one instead uses instead the distribution of
<em>max</em>|<em>t</em>| from each simulated set of effects, the
<em>simultaneous margin of error</em> (SME) results. The idea here is
that if it happens that <em>all</em> of the effects are inactive, it is
unlikely for any of their |<em>t</em>| ratios to exceed the SME. This,
if we observe some effects that do, it is pretty convincing evidence
that we do indeed have active effects in the mix. And that is the case
with our pilot-plant example, as you can see in the Pareto plot
above.</p>
<p>A non-graphical analysis showing all of these observed <em>t</em>
ratios, along with <em>P</em> values obtained as tail areas of the
reference distribution, is available via <code><a href="../reference/refdist.html">eff.test()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/refdist.html">eff.test</a></span><span class="op">(</span><span class="va">pilotEff</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     effect Zahn_PSE t.ratio p.value simult.pval</span></span>
<span><span class="co">## T     23.0 4.011005   5.734  0.0008      0.0054</span></span>
<span><span class="co">## TK    10.0 4.011005   2.493  0.0235      0.1419</span></span>
<span><span class="co">## C     -5.0 4.011005  -1.247  0.1632      0.7643</span></span>
<span><span class="co">## K      1.5 4.011005   0.374  0.7386      1.0000</span></span>
<span><span class="co">## TC     1.5 4.011005   0.374  0.7386      1.0000</span></span>
<span><span class="co">## TCK    0.5 4.011005   0.125  0.9152      1.0000</span></span>
<span><span class="co">## CK     0.0 4.011005   0.000  1.0000      1.0000</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="other-features">Other features<a class="anchor" aria-label="anchor" href="#other-features"></a>
</h2>
<p>Several sets of example effects are provided in the package:
<code>"bikeEff"</code>“, <code>"pdEff"</code>”, <code>"shnkEff"</code>,
<code>"shnkDisp"</code>“, and <code>"viseEff"</code> (see
<code><a href="../reference/examples.html">help("bikeEff")</a></code> for details).</p>
<p>Finally, if there is anyone wishing to construct half-normal plots by
hand, as originally done in Daniel’s 1959 paper, the
<code><a href="../reference/paper.html">daniel.paper()</a></code> function provides suitable graph paper for
the purpose.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/paper.html">daniel.paper</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
