<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Implementations of Yates's method for obtaining factor effects; and reverse Yates's method for recovering response values; and a generalization for balanced unreplicated experiments having other than two-level factors."><title>Yates's algorithm — yates • unrepx</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Yates's algorithm — yates"><meta property="og:description" content="Implementations of Yates's method for obtaining factor effects; and reverse Yates's method for recovering response values; and a generalization for balanced unreplicated experiments having other than two-level factors."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">unrepx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/overview.html">**unrepx** package for R</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rvlenth/unrepx/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Yates's algorithm</h1>
      
      <div class="d-none name"><code>yates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implementations of Yates's method for obtaining factor effects; and reverse Yates's method for recovering response values; and a generalization for balanced unreplicated experiments having other than two-level factors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">yates</span><span class="op">(</span><span class="va">y</span>, labels <span class="op">=</span> <span class="va">LETTERS</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu">gyates</span><span class="op">(</span><span class="va">y</span>, <span class="va">nlevels</span>, basis <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>y</dt>
<dd><p>Numeric vector of response values or effects, in standard order. See Details.</p></dd>

  <dt>labels</dt>
<dd><p>Character labels for 2-level factors to use when <code>y</code> contains resoponse values. The first \(log_2(n)\) are used, where \(n\) is <code>length(y).</code></p></dd>

  <dt>sep</dt>
<dd><p>Character to use between labels for interaction effects.</p></dd>

  <dt>nlevels</dt>
<dd><p>Numeric vector of numbers of levels. The number of observations is assumed to be <code>prod(nlevels).</code></p></dd>

  <dt>basis</dt>
<dd><p>Character value or vector specifying what method to use to generate orthonormal contrasts. Built-in ones include <code>"poly"</code> and <code>"helmert"</code>, but the user may create others. The elements of <code>basis</code> are recycled cyclically as needed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These functions implement a method for computing factor effects for balanced, unreplicated designs without need for a matrix of predictor levels. Instead, the responses must be arranged in standard order. The method is described in Yates (1937) for the case where all factors have two levels (as implemented in <code>yates</code>), and its generalization (<code>gyates</code>) can be found in Good (1958). Both are described in Drum (2005). In this implementation, <code>gyates()</code> uses orthonormal (unitary) matrices, rather than keeping track of needed divisors.</p>
<p>Standard order (also called Yates order) is that in which the first factor varies the fastest and the last varies the slowest. The <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></code> function creates factor combinations in standard order. The <code>yates</code> function is for experiments with all factors having two levels. The returned effects are also in standard order: with the default labels in <code>yates</code>, the order of the returned effects is (intercept), A, B, AB, C, AC, BC, ABC, D, etc.: note that absence or presence of each factor proceeds in standard order.</p>
<p>In both <code>yates</code> and <code>gyates</code>, if the length of <code>y</code> is one less than expected, <code>y</code> is assumed to be a set of effects, without the intercept. In that instance, the algorithm is reversed and the response values are recovered from the effects. Since the intercept is absent, the mean is arbitrary. If <code>y</code> has a <code>"mean"</code> attribute, the mean is adjusted to that value; otherwise, the recovered responses have a mean of zero.</p>
<p>In <code>gyates</code>, the values of <code>nlevels</code> and <code>basis</code> are saved as attributes. In a subsequent call on the returned effects, these values are used and will override the <code>nlevels</code> and <code>basis</code> arguments supplied by the user.</p>
<p>Effects are scaled to all have the same variance. In <code>yates</code>, we apply the same convention as in most design texts, e.g., Box et al. (2005): effect = (mean at "+" level) - (mean at "-" level), which is twice the regression coefficient one obtains by regressing <code>y</code> on predictors of -1s and +1s. In <code>gyates</code>, effects are computed using orthonormal contrasts, making the squared effects equal to their ANOVA sums of squares. When effects are reversed, the same scaling is assumed. Also, if the elements of <code>y</code> are independent, so are the effects.</p>
<p>The two basis functions supplied are <code>"poly"</code> and <code>"helmert"</code>, which are based on <code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.poly</a></code> and <code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.helmert</a></code> respectively. Users may create a custom basis, say <code>"foo"</code>, by writing a function <code>foo_gyb = function(k) {...}</code>, and supplying <code>basis = "foo"</code> in the call. The function should return a <code>k</code> by <code>k</code> matrix having its first column equal to <code>1/sqrt(k)</code> and orthonormal contrasts in the remaining columns.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>length(y)</code> is a power of two (in <code>yates</code>) or the product of <code>nlevels</code> (in <code>gyates</code>), a vector of <code>length(y) - 1</code> effects is returned (the intercept is omitted). In addition, the returned value has a <code>"mean"</code> attribute set equal to <code>mean(y)</code>. The effects from <code>yates</code> are named in standard order using the labels provided. The effects from <code>gyates</code> are labeled using patterns of the characters <code>.123456789</code>. Any <code>.</code> in a label indicates a factor whose effect is out of play. For illustration, with 3 factors, the effect named <code>.1.</code> is the first-order effect of the second factor, and the one named <code>23.</code> is the interaction of the second-order effect of the first factor and the third-order effect of the second factor.</p>


<p>If <code>length(y)</code> is one less than a power of two or the product of levels, then a vector one longer of response values is returned. The names of the returned responses are symbol combinations from <code>-+</code> for <code>yates</code>, and <code>123456789</code> from <code>gyates</code>. For example, in <code>yates</code> with <code>length(y) = 7</code>, the returned values are labeled <code>---, +--, -+-, ++-, --+, +-+, -++, +++</code>; and <code>gyates</code> with 5 effects and <code>nlevels = c(3, 2)</code>, the returned effects are labeled <code>11, 21, 31, 12, 22, 32</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Box, GEP, Hunter, JS, and Hunter, WG (2005)
<em>Statistics for Experimenters</em> (2nd ed)
New York: John Wiley &amp; Sons</p>
<p>Drum, M (2005)
Yates's Algorithm. <em>Encyclopedia of Biostatistics</em>, 8. Wiley.</p>
<p>Good, IJ (1958)
The interaction algorithm and practical Fourier analysis.
<em>Journal of the Royal Statistical Society, Series B</em> 20, 361-372.</p>
<p>Yates, F (1937) The design and analysis of factorial experiments. Technical Communication of the Commonwealth Bureau of Soils, 35, Commonwealth Agricultural Bureau, Farnham Royal</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Russell V. Lenth</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rvlenth/unrepx" class="external-link">"unrepx"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pilot-plant example, BH^2 p. 177</span></span></span>
<span class="r-in"><span><span class="fu">yates</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">72</span>, <span class="fl">54</span>, <span class="fl">68</span>,  <span class="fl">52</span>, <span class="fl">83</span>, <span class="fl">45</span>, <span class="fl">80</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"C"</span>, <span class="st">"K"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    T    C   TC    K   TK   CK  TCK </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23.0 -5.0  1.5  1.5 10.0  0.0  0.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"mean")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64.25 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># recover shrinkage data</span></span></span>
<span class="r-in"><span><span class="fu">yates</span><span class="op">(</span><span class="va">shnkEff</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---- +--- -+-- ++-- --+- +-+- -++- +++- ---+ +--+ -+-+ ++-+ --++ +-++ -+++ ++++ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48.5 57.5  8.8 17.5 18.5 14.5 22.5 17.5 12.5 12.0 45.5 53.5 17.0 27.5 34.2 58.2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A 3 x 2 x 4 example</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">214</span>, <span class="fl">193</span>, <span class="fl">207</span>,   <span class="fl">193</span>, <span class="fl">178</span>, <span class="fl">188</span>, </span></span>
<span class="r-in"><span>        <span class="fl">225</span>, <span class="fl">206</span>, <span class="fl">213</span>,   <span class="fl">221</span>, <span class="fl">214</span>, <span class="fl">216</span>, </span></span>
<span class="r-in"><span>        <span class="fl">227</span>, <span class="fl">213</span>, <span class="fl">221</span>,   <span class="fl">231</span>, <span class="fl">215</span>, <span class="fl">225</span>, </span></span>
<span class="r-in"><span>        <span class="fl">228</span>, <span class="fl">203</span>, <span class="fl">206</span>,   <span class="fl">190</span>, <span class="fl">178</span>, <span class="fl">195</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yeff</span> <span class="op">&lt;-</span> <span class="fu">gyates</span><span class="op">(</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, basis <span class="op">=</span> <span class="st">"helmert"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="refdist.html">eff.test</a></span><span class="op">(</span><span class="va">yeff</span><span class="op">)</span><span class="op">)</span>  <span class="co">## Show the largest few effects</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        effect Zahn_PSE t.ratio p.value simult.pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ..1  35.21837 8.766567   4.017  0.0006      0.0126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ..2  32.66667 8.766567   3.726  0.0011      0.0218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.. -32.25000 8.766567  -3.679  0.0012      0.0247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ..3 -23.57023 8.766567  -2.689  0.0122      0.2092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .1. -22.86190 8.766567  -2.608  0.0146      0.2483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .13 -21.68461 8.766567  -2.474  0.0190      0.3075</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

